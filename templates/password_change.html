<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
  <title>Change Password - Genpact Sales Assist</title>
  <!-- CSS files -->
  <link href="{% static 'tabler.min.css' %}" rel="stylesheet"/>
  <link href="{% static 'tabler-flags.min.css' %}" rel="stylesheet"/>
  <link href="{% static 'tabler-payments.min.css' %}" rel="stylesheet"/>
  <link href="{% static 'tabler-vendors.min.css' %}" rel="stylesheet"/>
  <link href="{% static 'demo.min.css' %}" rel="stylesheet"/>
  <style>
    @import url('https://rsms.me/inter/inter.css');
    :root {
      --tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif;
    }
    body {
      font-feature-settings: "cv03", "cv04", "cv11";
    }
  </style>
</head>
<script>
  // Function to show success message and redirect after a delay
  function showSuccessAndRedirect() {
    // Show success message
    var successAlert = document.getElementById('success-alert');
    successAlert.style.display = 'block';

    // Redirect to profile page after 10 seconds
    setTimeout(function() {
      window.location.href = '/login'; 
    }, 10000); // 10 seconds delay
  }
</script> 
</head>
<body class="d-flex flex-column">
  <script src="{% static 'demo-theme.min.js' %}"></script>
  <div class="page page-center">
    <div class="container container-tight py-4">
      <div class="text-center mb-4">
        <a href="../templates" class="navbar-brand navbar-brand-autodark"><img src="{% static 'Conagra_logo.png' %}" height="36" alt=""></a>
      </div>
      <div class="card card-md">
        <div class="card-body">
          <h2 class="h2 text-center mb-4">Change Your Password</h2>
          <form method="post" autocomplete="off" novalidate onsubmit="showSuccessAndRedirect();">
            {% csrf_token %}
            <div class="mb-3">
              <label class="form-label">Current Password</label>
              <input type="password" class="form-control" placeholder="Current Password" autocomplete="off" name="old_password">
            </div>
            <div class="mb-3">
              <label class="form-label">New Password</label>
              <input type="password" class="form-control" placeholder="New Password" autocomplete="off" name="new_password1">
            </div>
            <div class="mb-3">
              <label class="form-label">Confirm New Password</label>
              <input type="password" class="form-control" placeholder="Confirm New Password" autocomplete="off" name="new_password2">
            </div>
            <!-- Additional Fields -->
            <div class="mb-3">
              <label class="form-label">First Name</label>
              <input type="text" class="form-control" placeholder="Your First Name" autocomplete="off" name="first_name" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Last Name</label>
              <input type="text" class="form-control" placeholder="Your Last Name" autocomplete="off" name="last_name">
            </div>
            <div class="mb-3">
              <label class="form-label">Email</label>
              <input type="email" class="form-control" placeholder="Your Email" autocomplete="off" name="email" required>
            </div>
            <!-- End Additional Fields -->
            <div class="form-footer">
              <button type="submit" class="btn btn-primary w-100">Change Password</button>
            </div>
          </form>
          {% for message in messages %}
            <div class="alert alert-success" style="margin-top:20px;">
              <a class="close" href="change-password" data-dismiss="alert" style="margin-top:-12px">×</a>
              {{ message }}
            </div>
          {% endfor %}
          <!-- Display form errors -->
          {% if form.errors %}
            <div id="error-alert" class="alert alert-danger" style="margin-top:20px;">              
              <strong>Form Errors:</strong>
              <ul>
                {% for field, errors in form.errors.items %}
                  <li>{{ field|title }}:
                    <ul>
                      {% for error in errors %}
                        <li>{{ error }}</li>
                      {% endfor %}
                    </ul>
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}
          <script>
            // Hide the error message after 5 seconds
            setTimeout(function() {
                var errorAlert = document.getElementById('error-alert');
                if (errorAlert) {
                    errorAlert.style.display = 'none';
                }
            }, 8000); 
        </script>
          <!-- Success message and redirect -->
        <div id="success-alert" class="alert alert-success" style="margin-top:20px; display:none;">
          Password changed successfully! Redirecting to your profile in 10 seconds.
        </div>
      </div>
        </div>
      </div>
      <div class="text-center text-muted mt-3">
        Genpact Sales Assist - <a href="index.html" tabindex="-1">"Kellogg’s"</a>
      </div>
    </div>
  </div>
  <!-- Libs JS -->
  <!-- Tabler Core -->
  <script src="{% static 'tabler.min.js' %}" defer></script>
  <script src="{% static 'demo.min.js' %}" defer></script>
</body>
</html>
